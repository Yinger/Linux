# AWK
* AWK 和 sed 的区别
  * AWK 更像是脚本语言
  * AWK 用于 “比较规范”的文本处理，用于统计数量并输出指定字段
  * 使用 sed 将不规范的文本处理为“比较规范”的文本
* AWK 脚本的流程控制
  * 输入数据前例程 BEGIN{}
  * 主输入循环{}
  * 所有文件读取完成例程 END{}

## AWK 的字段引用和分离
* 记录和字段
  * 每行称作 AWK 的记录
  * 使用空格、制表符分隔开的单词称作字段
  * 可以自己指定分隔的字段
* 字段的引用
  * awk 中使用 ``` $1 $2 ... $n ``` 表示每一个字段
    * ``` awk '{print $1, $2, $3}' filename ```
  * awk 可以使用 -F 选项改变字段分隔符
    * ``` awk -F ',' '{print $1, $2, $3}' filename ```
    * 分隔符可以使用正则表达式
```
awk -F "'" '/menu/{ print $2 }' /boot/grub2/grub.cfg
awk -F "'" '/menu/{ print x++, $2 }' /boot/grub2/grub.cfg
```

## AWK 的表达式
* 赋值操作符
  * ``` = ``` 是最常用的赋值操作符
    * ``` var1 = "name" ```
    * ``` var2 = "hello" "world" ``` -> hello world
    * ``` var3 = $1 ``` -> $1:分隔开的第一个字段
  * 其他赋值操作符
    * ``` ++ -- += -= *= /= %= ^= ```
* 算数操作符
  * ``` + - * / % ^ ```
* 系统变量
  * FS 和 OFS 字段分隔符，OFS 表示输出的字段分隔符
  * RS 记录分隔符
  * NR 和 FNR 行数(多个文件时，NR 不会重排，FNR会重排)
  * NF 字段数量，最后一个字段内容可以用 ``` $NF ``` 取出
  ```
  head -5 /etc/passwd
  head -5 /etc/passwd | awk -F ":" '{print $1}'

  # FS
  head -5 /etc/passwd | awk 'BEGIN{FS=":"}{print $1,$2}'
  -> 
  root x
  bin x
  daemon x
  adm x
  lp x

  # FS OFS
  head -5 /etc/passwd | awk 'BEGIN{FS=":",OFS="-"}{print $1,$2}'
  ->
  root-x
  bin-x
  daemon-x
  adm-x
  lp-x

  # RS
  head -5 /etc/passwd | awk 'BEGIN{RS=":"}{print $0}'
  ->
  root
  x
  0
  root
  /root
  /bin/bash
  bin
  x
  1
  1
  bin
  /bin
  /sbin/nologin
  ...

  # NR
  head -5 /etc/passwd | awk '{print NR,$0}'
  # NR VS. FNR
  awk '{print FNR}' /etc/hosts /etc/hosts
  1
  2
  3
  1
  2
  3
  awk '{print NR}' /etc/hosts /etc/hosts
  1
  2
  3
  4
  5
  6

  # NF
  head -5 /etc/passwd | awk 'BEGIN{FS=":"}{print NF}'
  7
  7
  7
  7
  7
  # 输出最后一个字段的内容 $NF -> $7
  head -5 /etc/passwd | awk 'BEGIN{FS=":"}{print $NF}'
  ```
* 关系操作符
    * ``` < > <= >= == != ~ !~ ```
* 布尔操作符
  * ``` && || ! ```